<!DOCTYPE html><html lang="en" data-astro-transition-scope="astro-smooz4hq-4"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.4.9"><title>React Reducer Patterns - Dang Thanh Digital Garden</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono&family=Lexend:wght@400;500;600;700&family=Source+Code+Pro&display=swap" rel="stylesheet"><script defer data-domain="dangthanh.org" src="https://plausible.io/js/script.js"></script><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="stylesheet" href="/_astro/about.m4-pN1tM.css" />
<link rel="stylesheet" href="/_astro/_slug_.ZaaD1v9_.css" />
<style>@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0}}@keyframes astroFadeOut{to{opacity:0}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*),::view-transition-old(*),::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}
</style><script type="module" src="/_astro/hoisted.Cr-lckGz.js"></script><style>[data-astro-transition-scope="astro-dmvkmasx-1"] { view-transition-name: title-undefined; }@layer astro { ::view-transition-old(title-undefined) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(title-undefined) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(title-undefined) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(title-undefined) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-dmvkmasx-1"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-dmvkmasx-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-dmvkmasx-1"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-dmvkmasx-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-dmvkmasx-1"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-dmvkmasx-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-dmvkmasx-1"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-dmvkmasx-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-z5xp366c-2"] { view-transition-name: info-undefined; }@layer astro { ::view-transition-old(info-undefined) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(info-undefined) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(info-undefined) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(info-undefined) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-z5xp366c-2"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-z5xp366c-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-z5xp366c-2"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-z5xp366c-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-z5xp366c-2"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-z5xp366c-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-z5xp366c-2"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-z5xp366c-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-iukyfs2j-3"] { view-transition-name: astro-iukyfs2j-3; }@layer astro { ::view-transition-old(astro-iukyfs2j-3) { 
	animation-duration: 90ms, 220ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1), cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both, both;
	animation-name: astroFadeOut, astroSlideToLeft; }::view-transition-new(astro-iukyfs2j-3) { 
	animation-duration: 210ms, 220ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1), cubic-bezier(0.76, 0, 0.24, 1);
	animation-delay: 30ms;
	animation-fill-mode: both, both;
	animation-name: astroFadeIn, astroSlideFromRight; }[data-astro-transition=back]::view-transition-old(astro-iukyfs2j-3) { 
	animation-name: astroFadeOut, astroSlideToRight; }[data-astro-transition=back]::view-transition-new(astro-iukyfs2j-3) { 
	animation-name: astroFadeIn, astroSlideFromLeft; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-iukyfs2j-3"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-iukyfs2j-3"] { 
	animation-duration: 90ms, 220ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1), cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both, both;
	animation-name: astroFadeOut, astroSlideToLeft; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-iukyfs2j-3"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-iukyfs2j-3"] { 
	animation-duration: 210ms, 220ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1), cubic-bezier(0.76, 0, 0.24, 1);
	animation-delay: 30ms;
	animation-fill-mode: both, both;
	animation-name: astroFadeIn, astroSlideFromRight; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-iukyfs2j-3"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-iukyfs2j-3"] { 
	animation-name: astroFadeOut, astroSlideToRight; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-iukyfs2j-3"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-iukyfs2j-3"] { 
	animation-name: astroFadeIn, astroSlideFromLeft; }</style><style>[data-astro-transition-scope="astro-smooz4hq-4"] { view-transition-name: astro-smooz4hq-4; }@layer astro { ::view-transition-old(astro-smooz4hq-4) { animation: none; opacity: 0; mix-blend-mode: normal; }::view-transition-new(astro-smooz4hq-4) { animation: none; mix-blend-mode: normal; }::view-transition-group(astro-smooz4hq-4) { animation: none } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-smooz4hq-4"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-smooz4hq-4"] { animation: none; mix-blend-mode: normal; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-smooz4hq-4"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-smooz4hq-4"] { animation: none; mix-blend-mode: normal; }</style></head> <body> <div class="pos_relative max-w_3xl mx_auto px_4 md:px_6 lg:px_8"> <header role="banner" class="d_flex items_center justify_space-between py_3"> <a href="/" class="fs_3xl font_700 leading_1 d_flex gap_1 transition_transform_.3s_ease hover:transform_translate(3px,_3px)"> <span class="w_10 h_10 p_1.5 shadow_lg d_inline-flex justify_center items_center border-w_1px border-style_solid border_gray.50 rounded_3px transform_translateY(1px)">D</span> <span class="w_10 h_10 p_1.5 shadow_lg d_inline-flex justify_center items_center transform_translateY(-1px) border-w_1px border-style_solid border_gray.50 rounded_3px bg_gray.900 text_white">T</span> </a> <nav role="navigation" class="d_flex items_center justify_center"> <a href="/blog" class="decoration_wavy text-decoration-line_underline underline-offset_8px decoration_2px py_2 px_3"> Blog </a><a href="/tags" class="py_2 px_3 hover:decoration_wavy hover:text-decoration-line_underline hover:underline-offset_8px hover:decoration_2px"> Tags </a><a href="/projects" class="py_2 px_3 hover:decoration_wavy hover:text-decoration-line_underline hover:underline-offset_8px hover:decoration_2px"> Projects </a><a href="/about" class="py_2 px_3 hover:decoration_wavy hover:text-decoration-line_underline hover:underline-offset_8px hover:decoration_2px"> About </a> </nav> </header> <main role="main">  <div class="article"> <div class="w_full d_flex flex_column mt_12"> <a href="/blog" class="d_inline-flex items_center text_gray.500 text-decor_none fs_sm hover:text-decor_underline hover:underline-offset_2px">
&larr; from Blog
</a> <h1 class="fs_4xl font_700 leading_1 my_3" data-astro-transition-scope="astro-dmvkmasx-1"> React Reducer Patterns </h1> <div class="d_flex items_center gap_1.5 fs_sm text_gray.500 font_medium mb_8" data-astro-transition-scope="astro-z5xp366c-2"> <span>December 28, 2022</span> <span>&#8226;</span> <span>2 min read</span> </div> <div class="article" data-astro-transition-scope="astro-iukyfs2j-3">  <p>The reducer pattern is one of the commonly used patterns in React. Here are some patterns that can be useful for you when using it.</p>
<h2 id="toogle-boolean">Toogle Boolean</h2>
<p>The hooks is usefull for controlling toggle or other elements with a boolean state.</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#81A1C1">interface</span><span style="color:#D8DEE9FF"> ToggleProps </span><span style="color:#ECEFF4">{</span></span>
<span class="line"><span style="color:#D8DEE9FF">  initialState</span><span style="color:#81A1C1">?:</span><span style="color:#81A1C1"> boolean;</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">function</span><span style="color:#88C0D0"> useToggle</span><span style="color:#ECEFF4">({</span><span style="color:#D8DEE9"> initialState</span><span style="color:#81A1C1"> =</span><span style="color:#81A1C1"> false</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> ToogleProps</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#81A1C1">  const</span><span style="color:#ECEFF4"> [</span><span style="color:#D8DEE9">enabled</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> setEnabled</span><span style="color:#ECEFF4">]</span><span style="color:#81A1C1"> =</span><span style="color:#D8DEE9"> React</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">useReducer</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">previous</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1"> =&gt;</span><span style="color:#81A1C1"> !</span><span style="color:#D8DEE9">previous</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> initialState</span><span style="color:#D8DEE9FF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">  return</span><span style="color:#D8DEE9FF"> [</span><span style="color:#D8DEE9">enabled</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> setEnabled</span><span style="color:#D8DEE9FF">]</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span></code></pre>
<h2 id="select-or-deselect-an-item">Select or deselect an item</h2>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#81A1C1">interface</span><span style="color:#D8DEE9FF"> SelectionProps</span><span style="color:#ECEFF4">&lt;</span><span style="color:#D8DEE9FF">T</span><span style="color:#ECEFF4">&gt;</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#88C0D0">  isEqual</span><span style="color:#81A1C1">?:</span><span style="color:#ECEFF4"> (</span><span style="color:#D8DEE9">prev</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> T </span><span style="color:#81A1C1">|</span><span style="color:#8FBCBB"> undefined</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> next</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> T</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1"> =&gt;</span><span style="color:#81A1C1"> boolean;</span></span>
<span class="line"><span style="color:#D8DEE9FF">  initialState</span><span style="color:#81A1C1">?:</span><span style="color:#D8DEE9FF"> T </span><span style="color:#81A1C1">|</span><span style="color:#8FBCBB"> undefined</span><span style="color:#81A1C1">;</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">function</span><span style="color:#88C0D0"> useSelection</span><span style="color:#ECEFF4">&lt;</span><span style="color:#D8DEE9FF">T</span><span style="color:#ECEFF4">&gt;({</span><span style="color:#D8DEE9"> isEqual</span><span style="color:#81A1C1"> =</span><span style="color:#ECEFF4"> (</span><span style="color:#D8DEE9">prev</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> next</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1"> =&gt;</span><span style="color:#D8DEE9"> prev</span><span style="color:#81A1C1"> ===</span><span style="color:#D8DEE9"> next</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> initialState</span><span style="color:#81A1C1"> =</span><span style="color:#81A1C1"> undefined</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> SelectionProps </span><span style="color:#81A1C1">=</span><span style="color:#ECEFF4"> {})</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#81A1C1">  const</span><span style="color:#ECEFF4"> [</span><span style="color:#D8DEE9">selection</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> setSelection</span><span style="color:#ECEFF4">]</span><span style="color:#81A1C1"> =</span><span style="color:#D8DEE9"> React</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">useReducer</span><span style="color:#D8DEE9FF">(</span></span>
<span class="line"><span style="color:#ECEFF4">    (</span><span style="color:#D8DEE9">prev</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> T </span><span style="color:#81A1C1">|</span><span style="color:#8FBCBB"> undefined</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> next</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> T</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1"> =&gt;</span></span>
<span class="line"><span style="color:#D8DEE9FF">      (</span><span style="color:#88C0D0">isEqual</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">prev</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> next</span><span style="color:#D8DEE9FF">) </span><span style="color:#81A1C1">?</span><span style="color:#81A1C1"> undefined</span><span style="color:#81A1C1"> :</span><span style="color:#D8DEE9"> next</span><span style="color:#D8DEE9FF">)</span><span style="color:#ECEFF4">,</span></span>
<span class="line"><span style="color:#D8DEE9">    initialState</span><span style="color:#ECEFF4">,</span></span>
<span class="line"><span style="color:#D8DEE9FF">  )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">  return</span><span style="color:#D8DEE9FF"> [</span><span style="color:#D8DEE9">select</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> setSelection</span><span style="color:#D8DEE9FF">]</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span></code></pre>
<h2 id="selecting-multiple-items">Selecting multiple items</h2>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#81A1C1">interface</span><span style="color:#D8DEE9FF"> MultiSelectionProps</span><span style="color:#ECEFF4">&lt;</span><span style="color:#D8DEE9FF">T</span><span style="color:#ECEFF4">&gt;</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#88C0D0">  isEqual</span><span style="color:#81A1C1">?:</span><span style="color:#ECEFF4"> (</span><span style="color:#D8DEE9">prev</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> T</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> next</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> T</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1"> =&gt;</span><span style="color:#81A1C1"> boolean;</span></span>
<span class="line"><span style="color:#D8DEE9FF">  initialState</span><span style="color:#81A1C1">?:</span><span style="color:#D8DEE9FF"> T[]</span><span style="color:#81A1C1">;</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">function</span><span style="color:#88C0D0"> useMultipleSelection</span><span style="color:#ECEFF4">&lt;</span><span style="color:#D8DEE9FF">T</span><span style="color:#ECEFF4">&gt;({</span></span>
<span class="line"><span style="color:#D8DEE9">  isEqual</span><span style="color:#81A1C1"> =</span><span style="color:#ECEFF4"> (</span><span style="color:#D8DEE9">prev</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> next</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1"> =&gt;</span><span style="color:#D8DEE9"> prev</span><span style="color:#81A1C1"> ===</span><span style="color:#D8DEE9"> next</span><span style="color:#ECEFF4">,</span></span>
<span class="line"><span style="color:#D8DEE9">  initialState</span><span style="color:#81A1C1"> =</span><span style="color:#D8DEE9FF"> []</span><span style="color:#ECEFF4">,</span></span>
<span class="line"><span style="color:#ECEFF4">}</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> MultipleSelectionProps</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#81A1C1">  const</span><span style="color:#ECEFF4"> [</span><span style="color:#D8DEE9">selection</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> setSelection</span><span style="color:#ECEFF4">]</span><span style="color:#81A1C1"> =</span><span style="color:#D8DEE9"> React</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">useReducer</span><span style="color:#D8DEE9FF">(</span></span>
<span class="line"><span style="color:#ECEFF4">    (</span><span style="color:#D8DEE9">prev</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> T[]</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> next</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> T[]</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1"> =&gt;</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#81A1C1">      const</span><span style="color:#D8DEE9"> index</span><span style="color:#81A1C1"> =</span><span style="color:#D8DEE9"> prev</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">findIndex</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">x</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1"> =&gt;</span><span style="color:#88C0D0"> isEqual</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">x</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> next</span><span style="color:#D8DEE9FF">))</span></span>
<span class="line"><span style="color:#81A1C1">      return</span><span style="color:#D8DEE9"> index</span><span style="color:#81A1C1"> ===</span><span style="color:#81A1C1"> -</span><span style="color:#B48EAD">1</span><span style="color:#81A1C1"> ?</span><span style="color:#D8DEE9FF"> [</span><span style="color:#81A1C1">...</span><span style="color:#D8DEE9">prev</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> next</span><span style="color:#D8DEE9FF">] </span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9"> prev</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">filter</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">_</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> i</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1"> =&gt;</span><span style="color:#D8DEE9"> i</span><span style="color:#81A1C1"> !==</span><span style="color:#D8DEE9"> index</span><span style="color:#D8DEE9FF">)</span></span>
<span class="line"><span style="color:#ECEFF4">  },</span><span style="color:#D8DEE9"> initialState</span><span style="color:#D8DEE9FF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">  return</span><span style="color:#D8DEE9FF"> [</span><span style="color:#D8DEE9">selection</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> setSelection</span><span style="color:#D8DEE9FF">]</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span></code></pre>
<h2 id="menu-or-exclusive-value">Menu or exclusive Value</h2>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#81A1C1">type</span><span style="color:#D8DEE9FF"> Menu </span><span style="color:#81A1C1">=</span><span style="color:#8FBCBB"> undefined</span><span style="color:#81A1C1"> |</span><span style="color:#ECEFF4"> &#39;</span><span style="color:#A3BE8C">file</span><span style="color:#ECEFF4">&#39;</span><span style="color:#81A1C1"> |</span><span style="color:#ECEFF4"> &#39;</span><span style="color:#A3BE8C">edit</span><span style="color:#ECEFF4">&#39;</span><span style="color:#81A1C1"> |</span><span style="color:#ECEFF4"> &#39;</span><span style="color:#A3BE8C">view</span><span style="color:#ECEFF4">&#39;</span><span style="color:#616E88"> // undefined mean closed</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">const</span><span style="color:#ECEFF4"> [</span><span style="color:#D8DEE9">openMenu</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> tap</span><span style="color:#ECEFF4">]</span><span style="color:#81A1C1"> =</span><span style="color:#D8DEE9"> React</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">useReducer</span><span style="color:#D8DEE9FF">(</span></span>
<span class="line"><span style="color:#ECEFF4">  (</span><span style="color:#D8DEE9">current</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> Menu</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> action</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> Menu</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1"> =&gt;</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#81A1C1">    return</span><span style="color:#D8DEE9"> action</span><span style="color:#81A1C1"> ===</span><span style="color:#D8DEE9"> current</span><span style="color:#81A1C1"> ?</span><span style="color:#81A1C1"> null</span><span style="color:#81A1C1"> :</span><span style="color:#D8DEE9"> action</span></span>
<span class="line"><span style="color:#ECEFF4">},</span><span style="color:#81A1C1"> undefined</span><span style="color:#D8DEE9FF">)</span></span></code></pre>
<h2 id="jitter-generator">Jitter Generator</h2>
<p>Inspired by AWS: <a href="https://aws.amazon.com/blogs/architecture/exponential-backoff-and-jitter/">Exponential Backoff And Jitter</a></p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#81A1C1">const</span><span style="color:#D8DEE9"> baseMs</span><span style="color:#81A1C1"> =</span><span style="color:#B48EAD"> 5</span></span>
<span class="line"><span style="color:#81A1C1">const</span><span style="color:#D8DEE9"> capMs</span><span style="color:#81A1C1"> =</span><span style="color:#B48EAD"> 2000</span></span>
<span class="line"><span style="color:#81A1C1">const</span><span style="color:#ECEFF4"> [{</span><span style="color:#D8DEE9"> attempt</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> delayMs</span><span style="color:#ECEFF4"> },</span><span style="color:#D8DEE9"> dispatch</span><span style="color:#ECEFF4">]</span><span style="color:#81A1C1"> =</span><span style="color:#D8DEE9"> React</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">useReducer</span><span style="color:#D8DEE9FF">(</span></span>
<span class="line"><span style="color:#ECEFF4">  (</span><span style="color:#D8DEE9">state</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> random</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1"> =&gt;</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#81A1C1">    return</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#88C0D0">      attempt</span><span style="color:#ECEFF4">:</span><span style="color:#D8DEE9"> state</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">attempt</span><span style="color:#81A1C1"> +</span><span style="color:#B48EAD"> 1</span><span style="color:#ECEFF4">,</span></span>
<span class="line"><span style="color:#88C0D0">      delayMs</span><span style="color:#ECEFF4">:</span><span style="color:#D8DEE9"> random</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9"> Math</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">min</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">capMs</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> baseMs</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9"> Math</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">pow</span><span style="color:#D8DEE9FF">(</span><span style="color:#B48EAD">2</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> attempt</span><span style="color:#D8DEE9FF">))</span><span style="color:#ECEFF4">,</span></span>
<span class="line"><span style="color:#ECEFF4">    }</span></span>
<span class="line"><span style="color:#ECEFF4">  },</span></span>
<span class="line"><span style="color:#ECEFF4">  {</span><span style="color:#88C0D0"> attempt</span><span style="color:#ECEFF4">:</span><span style="color:#B48EAD"> 0</span><span style="color:#ECEFF4">,</span><span style="color:#88C0D0"> delay</span><span style="color:#ECEFF4">:</span><span style="color:#D8DEE9"> baseMs</span><span style="color:#ECEFF4"> },</span></span>
<span class="line"><span style="color:#D8DEE9FF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">const</span><span style="color:#D8DEE9"> nextAttempt</span><span style="color:#81A1C1"> =</span><span style="color:#D8DEE9"> React</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">useCallback</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">()</span><span style="color:#81A1C1"> =&gt;</span><span style="color:#88C0D0"> dispatch</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">Math</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">random</span><span style="color:#D8DEE9FF">())</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9FF"> [</span><span style="color:#D8DEE9">dispatch</span><span style="color:#D8DEE9FF">])</span></span></code></pre>
<h2 id="logical-clock-or-force-update">Logical Clock or Force Update</h2>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#81A1C1">const</span><span style="color:#ECEFF4"> [</span><span style="color:#D8DEE9">t</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> tick</span><span style="color:#ECEFF4">]</span><span style="color:#81A1C1"> =</span><span style="color:#D8DEE9"> React</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">useReducer</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">n</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1"> =&gt;</span><span style="color:#D8DEE9"> n</span><span style="color:#81A1C1"> +</span><span style="color:#B48EAD"> 1</span><span style="color:#ECEFF4">,</span><span style="color:#B48EAD"> 0</span><span style="color:#D8DEE9FF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">function</span><span style="color:#88C0D0"> useForceUpdate</span><span style="color:#ECEFF4">()</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#81A1C1">  const</span><span style="color:#ECEFF4"> [</span><span style="color:#D8DEE9">ignored</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> forceUpdate</span><span style="color:#ECEFF4">]</span><span style="color:#81A1C1"> =</span><span style="color:#D8DEE9"> React</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">useReducer</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">n</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1"> =&gt;</span><span style="color:#D8DEE9"> n</span><span style="color:#81A1C1"> +</span><span style="color:#B48EAD"> 1</span><span style="color:#ECEFF4">,</span><span style="color:#B48EAD"> 0</span><span style="color:#D8DEE9FF">)</span></span>
<span class="line"><span style="color:#81A1C1">  return</span><span style="color:#D8DEE9FF"> [</span><span style="color:#D8DEE9">ignored</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> forceUpdate</span><span style="color:#D8DEE9FF">]</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span></code></pre>  </div> <div class="d_flex items_center"> <div class="d_flex items_center gap-y_0.5"> <a href="/tags/JavaScript" class="d_inline-flex items_center py_2 px_1 text_gray.500 hover:text-decor_underline hover:underline-offset_2px">
#JavaScript </a><a href="/tags/TypeScript" class="d_inline-flex items_center py_2 px_1 text_gray.500 hover:text-decor_underline hover:underline-offset_2px">
#TypeScript </a><a href="/tags/React" class="d_inline-flex items_center py_2 px_1 text_gray.500 hover:text-decor_underline hover:underline-offset_2px">
#React </a> </div> </div> </div> </div>  </main> <hr class="border-style_solid border_gray.300 w_full mt_6"> <footer role="contentinfo" class="py_5"> <div class="d_flex items_center flex_column md:justify_space-between md:flex_row"> <div>
&copy; 2024. Made with <span>❤</span>&nbsp;
<a href="https://astro.build/" target="_blank" rel="noopener noreferrer">Astro</a> </div> <div class="d_flex items_center justify_end gap_1.5">  <a href="https://github.com/dangvanthanh" target="_blank" rel="noopener noreferrer" class="s"> github </a> <span>&bull;</span>  <a href="https://www.linkedin.com/in/dangthanh/" target="_blank" rel="noopener noreferrer" class="s"> linkedin </a> <span>&bull;</span>  <a href="https://twitter.com/dangvanthanh" target="_blank" rel="noopener noreferrer" class="s"> twitter </a> <span>&bull;</span> <a href="mailto:dangvanthanh@dangthanh.org" class="s"> email </a> </div> </div> </footer> </div>  </body> </html>