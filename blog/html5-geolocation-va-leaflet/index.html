<!DOCTYPE html>
<html lang="vi"><meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>HTML5 Geolocation và Leaflet -Dang Thanh Blog</title>
<meta name="description" content="Blog chia sẻ về web và phát triển web">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="57x57" href="/images/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/images/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/images/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/images/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/images/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/images/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/images/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/images/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/images/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png">
<link rel="manifest" href="/images/favicon/manifest.json">
<link rel="mask-icon" href="/images/favicon/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/images/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link href="https://fonts.googleapis.com/css?family=Fira+Mono|Roboto+Slab&amp;subset=vietnamese" rel="stylesheet">

<link rel="stylesheet" href="https://dangthanh.org/css/anitya.min.4039eaaf51fa0c132aa1099f0415f4dbed9872003b79fcd2e36f45bf2b5bd511.css" integrity="sha256-QDnqr1H6DBMqoQmfBBX02&#43;2YcgA7efzS429Fvytb1RE=">
<link href="" rel="alternate" type="application/rss+xml" title="Dang Thanh Blog">
<body>
      <div class="site"><header role="banner" class="site-header">
  <div class="site-logo">
      <a href="/">DT</a>
  </div>
  <nav role="navigation" class="site-nav">
    <ul class="no-list m-0 p-0">
      <li>
        <a href="/" data-link="home" class="no-underline hover:line-through">Bài viết</a>
      </li>
      <li>
        <a href="/tags" data-link="tags" class="no-underline hover:line-through">Danh mục</a>
      </li>
      <li>
        <a href="/archives" data-link="archives" class="no-underline hover:line-through">Lưu trữ</a>
      </li>
      <li>
        <a href="/about" data-link="about" class="no-underline hover:line-through">Về tôi</a>
      </li>
    </ul>
  </nav>
</header>
<main role="main" class="site-main">
          <div id="main">
            <c-appearance></c-appearance><div class="article article-single" itemscope itemtype="//schema.org/Article">
    
      <h2 itemprop="headline">HTML5 Geolocation và Leaflet</h2>
      <ul class="no-list p-0 m-0">
      
        <li class="inline-block"><a href="/tags/javascript" class="tag tag-javascript">javascript</a></li>
      
      </ul>
    

    <div class="article-body" itemprop="articleBody">
      

<p>Geolocation là một API mới của HTML5 cho phép bạn truy cập vào vị trí hiện tại của bạn trên thiết bị.</p>

<p>Geolocation gồm 3 phương thức:</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="cm">/**
</span><span class="cm"> * Lấy vị trí hiện tại của thiết bị
</span><span class="cm"> */</span>
<span class="nx">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">getCurrentPosition</span><span class="p">();</span>

<span class="cm">/**
</span><span class="cm"> * Cho phép khởi tạo một xử lí khi thiết bị thay đổi vị trí
</span><span class="cm"> */</span>
<span class="nx">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">watchPosition</span><span class="p">();</span>

<span class="cm">/**
</span><span class="cm"> * Xóa xử lí được khởi tạo trước đó bởi watchPosition()
</span><span class="cm"> */</span>
<span class="nx">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">clearWatch</span><span class="p">()</span>
</code></pre></div>
<h3 id="lấy-vị-trí-hiện-tại-sử-dụng-geolocation">Lấy vị trí hiện tại sử dụng Geolocation</h3>

<p>Để lấy vị trí hiện tại ta có thể sử dụng phương thức</p>

<ul>
<li><strong>navigator.geolocation.getCurrentPosition()</strong></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">success</span><span class="p">(</span><span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
	<span class="kd">var</span>	<span class="nx">latitude</span> <span class="o">=</span> <span class="nx">position</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">latitude</span><span class="p">,</span>
		<span class="nx">longitude</span> <span class="o">=</span> <span class="nx">position</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">longitude</span><span class="p">,</span>
		<span class="nx">altitude</span> <span class="o">=</span> <span class="nx">position</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">altitude</span><span class="p">,</span>
		<span class="nx">accuracy</span> <span class="o">=</span> <span class="nx">position</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">accuracy</span><span class="p">;</span>

	<span class="c1">// Hiển thị các thông số về vị trí hiện tại của bạn.
</span><span class="c1"></span>	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">latitude</span><span class="p">);</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">longitude</span><span class="p">);</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">altitude</span><span class="p">);</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">accuracy</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">error</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Không thể truy cập đến vị trí hiện tại.&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">enableHighAccuracy</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">timeout</span><span class="o">:</span> <span class="mi">5000</span><span class="p">,</span>
  <span class="nx">maximumAge</span><span class="o">:</span> <span class="mi">0</span>
<span class="p">}</span>

<span class="nx">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">getCurrentPosition</span><span class="p">(</span><span class="nx">success</span><span class="p">,</span> <span class="nx">error</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
</code></pre></div>
<h3 id="leaflet-là-gì">Leaflet là gì?</h3>

<p><a href="http://leafletjs.com/">Leaflet</a> là một thư viện JavaScript mã nguồn mở cung cấp các tương tác với bản đồ thân thiện với các thiết bị di động.</p>

<p>Cũng như Google Map API. Nhưng Leaflet được thiết kế đơn giản, hiệu quả và dễ sử dụng:</p>

<ul>
<li>Dễ dàng tương tác với HTML5 và CSS3.</li>
<li>Hỗ trợ rất nhiều plugin.</li>
<li>Tài liệu hướng dẫn về API rất tốt và dễ sử dụng</li>
<li>Cung cấp đầy đủ các tính năng để tương tác với bản đồ.</li>
</ul>

<p>Với API của Leaflet ta có thể tương tác với bản đồ một cách linh hoạt hơn. Sau đây là ví dụ làm việc đơn giản với Leaflet</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="cm">/**
</span><span class="cm"> * Khởi tạo bản đồ với &#34;map&#34; div
</span><span class="cm"> * với vị trí latitude, longitude và zoom bản đồ
</span><span class="cm"> */</span>
<span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="s1">&#39;map&#39;</span><span class="p">,</span> <span class="p">{</span>
	<span class="nx">center</span><span class="o">:</span> <span class="p">[</span><span class="nx">latitude</span><span class="p">,</span> <span class="nx">longitude</span><span class="p">],</span>
	<span class="nx">zoom</span><span class="o">:</span> <span class="mi">16</span>
<span class="p">});</span>

<span class="cm">/**
</span><span class="cm"> * Khởi tạo và hiển thị các lớp trên bản đồ
</span><span class="cm"> * Bạn vào Cloudmade.com đăng kí một tài khoản để có thể lấy API
</span><span class="cm"> */</span>
<span class="kd">var</span> <span class="nx">tile</span> <span class="o">=</span> <span class="s1">&#39;http://{s}.tile.cloudmade.com/{key}/{styleId}/256/{z}/{x}/{y}.png&#39;</span><span class="p">;</span>

<span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="nx">tile</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">key</span><span class="o">:</span> <span class="s1">&#39;760506895e284217a7442ce2efe97797&#39;</span><span class="p">,</span> <span class="c1">// Đây là API mình đã đăng kí với cloudmade
</span><span class="c1"></span>    <span class="nx">styleId</span><span class="o">:</span> <span class="mi">103288</span><span class="p">,</span>
    <span class="nx">maxZoom</span><span class="o">:</span> <span class="mi">16</span>
  <span class="p">}).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span>

<span class="cm">/**
</span><span class="cm"> * Đánh dấu vị trí trên bản đồ
</span><span class="cm"> */</span>
<span class="kd">var</span> <span class="nx">maker</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">marker</span><span class="p">([</span><span class="nx">latitude</span><span class="p">,</span> <span class="nx">longitude</span><span class="p">]).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span>
<span class="c1">// Hiển thị Popup tại vị trí đánh dấu
</span><span class="c1"></span><span class="nx">marker</span><span class="p">.</span><span class="nx">bindPopup</span><span class="p">(</span><span class="s1">&#39;&lt;p&gt;Tiêu đề...&lt;/p&gt;&#39;</span><span class="p">).</span><span class="nx">openPopup</span><span class="p">();</span>
</code></pre></div>



 


<p data-height="290"
	data-theme-id="652"
	data-slug-hash="tlpLG"
	data-user="dangvanthanh"
	data-default-tab="result"
	class="codepen">
</p>


<p>Ngoài ra, bạn có thể vào những liên kết sau để tìm hiểu thêm về Geolocation và Leaflet:</p>

<ul>
<li><a href="http://www.w3.org/TR/geolocation-API/">W3 - Geolocation API</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/WebAPI/Using_geolocation">Developer Mozilla</a></li>
<li><a href="http://leafletjs.com/reference.html">Leaflet API</a></li>
<li><a href="http://cloudmade.com/">Cloudmade</a></li>
</ul>

    </div>
    
      <section itemscope itemtype="//schema.org/Person" class="site-author cf">
  <img itemprop="image" src="https://avatars2.githubusercontent.com/u/2674850?v=3&s=100" class="fl" alt="Đặng Văn Thanh">
  <div class="fl">
    <h4 itemprop="author">Đặng Văn Thanh</h4>
    <span itemprop="description">Có đam mê về lập trình và các vấn đề về phát triển web.</span>
  </div>
</section>

      
  


  <aside class="article-body article-related mt-40">
    <h3>Bài viết cùng chủ đề</h3>
    <ul>
      
      
        <li><a href="/blog/tim-kiem-voi-algolia-hugo-va-vue/">Tìm kiếm với Algolia, Hugo và Vue.js</a>
      
        <li><a href="/blog/bat-dau-voi-vue/">Bắt đầu với Vue.js</a>
      
        <li><a href="/blog/redesign-va-nhung-gi-t%C3%B4i-hoc/">Redesign và những gì tôi học</a>
      
        <li><a href="/blog/tao-mp3-player-voi-html5-va-css3/">Tạo MP3 Player với HTML5 và CSS3</a>
      
        <li><a href="/blog/html5-fullscreen-api/">HTML5 Fullscreen API</a>
      
    </ul>
  </aside>


    
  </div>
          </div><footer role="contentinfo" class="site-footer">
  <p>
    &copy;2013 - 2018. Được xây dựng bằng
    <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo</a>,
    <a href="https://vuejs.org/" rel="noopener" target="_blank">Vue.js</a>.
  </p>
</footer>


</main>
      </div>
<script type="text/javascript" defer>
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-41117458-1']);
	_gaq.push(['_trackPageview']);
	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>


<script defer src="//codepen.io/assets/embed/ei.js"></script>
<script defer src="//unpkg.com/vue@2.5.17/dist/vue.min.js"></script>
<script defer src="//cdn.jsdelivr.net/npm/vue-instantsearch@1.7.0/dist/vue-instantsearch.js"></script>




<script defer src="https://dangthanh.org/js/anitya-component.min.6d8d703ea312b20afb0dd5dea619d13c2d4eb592751883942f8300cf4edb4722.js" integrity="sha256-bY1wPqMSsgr7DdXephnRPC1OtZJ1GIOUL4MAz07bRyI="></script>
<script defer src="https://dangthanh.org/js/anitya.min.73005194729b4f433e31a0696c86448c7935999d61bab1aa54c7c88cdaf707ac.js" integrity="sha256-cwBRlHKbT0M&#43;MaBpbIZEjHk1mZ1hurGqVMfIjNr3B6w="></script>
</body>
</html>
